网页版在线地毯排版工具功能需求文档
一、行业软件分析
主流软件优缺点：
1. Adobe Illustrator  
   - 优点：矢量绘制精准，插件生态丰富  
   - 缺点：学习成本高，无地毯专业模板  

2. CorelDRAW  
   - 优点：色彩管理优秀，适合图案重复排列  
   - 缺点：网页兼容性差  

3. 专业地毯软件（如NedGraphics）  
   - 优点：行业专用材质库，自动计算耗材  
   - 缺点：价格昂贵，操作复杂  

二、基础绘制模块需求
1. 画布系统

| 功能层级 | 子功能 | 详细说明 |
|---------|--------|----------|
| 1.1 画布设置 | 尺寸预设 | 提供常用地毯尺寸模板（如2x3m/4x6m） |
|         | 自定义尺寸 | 支持mm/cm/m单位输入，精度0.1cm |
|         | 分辨率设置 | 默认150dpi，可调范围72-300dpi |
| 1.2 视图控制 | 缩放 | 鼠标滚轮缩放（10%-1000%）+ 快捷键支持 |
|         | 平移 | 空格键+拖拽画布 |
|         | 标尺/网格 | 可开关的像素网格+物理尺寸标尺 |

2. 矢量绘制工具

| 功能层级 | 子功能 | 详细说明 |
|---------|--------|----------|
| 2.1 基础图形 | 直线/矩形/圆形 | 支持固定比例锁定（Shift） |
|         | 多边形 | 3-12边型参数化绘制 |
|         | 门框预设 | 户型图专业图示预设 |
|         | 自由路径 | 贝塞尔曲线编辑（锚点/手柄控制） |
| 2.2 编辑功能 | 节点编辑 | 添加/删除锚点，转换平滑/尖角 |
|         | 布尔运算 | 并集/差集/交集操作 |
|         | 对齐分布 | 基于选择集的智能对齐 |

3. 图案处理

| 功能层级 | 子功能 | 详细说明 |
|---------|--------|----------|
| 3.1 重复排列 | 线性阵列 | 行/列数、间距控制（支持自动填满画布） |
|         | 径向阵列 | 环形复制数量/角度设置 |
| 3.2 变形工具 | 自由变换 | 支持斜切/扭曲（Ctrl+拖拽控制点） |
|         | 封套变形 | 网格变形工具（4x4至8x8网格可选） |

4. 色彩系统

| 功能层级 | 子功能 | 详细说明 |
|---------|--------|----------|
| 4.1 填色 | 纯色填充 | HEX/RGB/CMYK色值输入 |
|         | 渐变填充 | 线性/径向渐变编辑器 |
| 4.2 色板 | 材质库 | 预加载羊毛/腈纶等材质色卡 |
|         | Pantone支持 | 输入色号自动匹配最近似地毯纱线色 |

三、技术实现建议
- 核心框架：
    - **React 18**：使用Function Component + Hooks模式 
    - **路由**：React Router 6（动态路由懒加载）
    - **状态管理**：Zustand（针对画布高频操作优化）
- 图形处理：
    - **基础绘制**：Fabric.js +  Paper.js 
    - **高性能2D图形**：Konva+React-Konva	
    - **参数化设计工具**：Leva+自定义渲染	
- 辅助库
     **拖拽**：`dnd-kit`（支持画布内元素排序）
    - **色彩**：`react-colorful` + Pantone商业色库API 
    - **文件解析**：pdf-lib（处理AI/EPS导入）
- 关键算法：  
   - 实时渲染优化：使用WebGL加速图案重复计算  
   - 路径简化：Ramer-Douglas-Peucker算法优化复杂曲线
- 数据格式：  
   - 输入：支持AI/EPS矢量文件导入  
   - 输出：生成包含纱线用量的JSON生产清单
- 性能优化
    - **虚拟化技术**：画布外元素使用React-Window 
    - **Web Worker**：将排版计算移至worker线程 
    - **差分更新**：使用`fabric.Object.set` 替代全量渲染 

四、进阶功能预留
1. 智能排版：根据图案尺寸自动计算最优排列方案

